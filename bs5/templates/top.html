<div class="menu-top pb-2">
    <form>
        <div class="input-group">
            <input type="text" class="form-control" id="top-search" placeholder="SEARCH...">
            <button type="submit" class="btn btn-outline-info"><i class="fas fa-fw fa-search"></i></button>
            <button type="button" class="btn btn-outline-secondary" data-bs-toggle="offcanvas"
                    data-bs-target="#his" aria-controls="offcanvasNavbar">
                <i class="fas fa-fw fa-history"></i>
            </button>
            <button type="button" class="btn btn-outline-secondary" data-bs-toggle="modal"
                    data-bs-target="#"><i class="fas fa-fw fa-lock"></i></button>
        </div>
    </form>
</div>
<script>

    function progress(data){
        console.log('progress', data);
        let kid = escape(data.kid);
        {#let kid = data.kid;#}
        {#kid.split("").map(item => {#}
        {#    arr.includes(item) ? item = "\\" + `\\${item}` : null;#}
        {#    return item#}
        {# }).join("");#}
        let $btn = $(`#${kid}`);
        if (data.progress === 100){
            $btn.attr('disabled', false);
        } else {
            $btn.attr('disabled', true);
        }
    }

    function his(data){
        $('#his textarea').append(data)
    }

    let http = 'http://' + document.domain + (location.port ? ":" + location.port : "");
    let io_security = io.connect(http + '/security',{'sync disconnect on unload': true});
    let io_dsp = io.connect(http + '/dsp', {'sync disconnect on unload': true});

    io_security.emit('join', {'room': 'progress'});
    io_security.on('his', his);
    io_security.on('progress', progress);

    io_dsp.emit('join', {'room': 'progress'});
    io_dsp.on('his', his);
    io_dsp.on('progress', progress);

    $(document).ready(function () {
        $(".modal").draggable();
        let $his = $('#his');

        $his.on('click', '.clean', function () {
            $('#his textarea').empty();
        });
        $his.on('click', '.med', function () {
            $his.css("width", '50%');
        });
        $his.on('click', '.max', function () {
            $his.css("width", '100%');
        });
        $his.on('click', '.min', function () {
            $his.css("width", '30%');
        });
    });
</script>